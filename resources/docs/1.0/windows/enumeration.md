# Enumeration

---

- [Automated](#automated)
- [Manual](#manual)

<a name="automated"></a>
## Automated
Dumps the groups on the system.
```sh
windows-privesc-check --dump -G
```

<a name="manual"></a>
## Manual
Displays username shell is running as.
```sh
whoami
```

Shows integrity level (Mandatory Label)
```sh
whoami /groups
```

Show the privileges
```sh
whoami /priv
```

Shows additional information about the user “student”. Includes groups user is in.
```sh
net user student
```

Displays other accounts on this system.
```sh
net user
```

Displays the hostname of the machine. May contain userful information such as “web” or “db” etc.
```sh
hostname
```

Display OS name, version and type.
```sh
systeminfo | findstr /B /C:"OS Name" /C:"OS Version" /C:"System Type"
```

List running processes. Does not list processes run by priviledged users.
```sh
tasklist
```

List running processes that are part of a windows service. Does not list processes run by priviledged users.
```sh
tasklist /SVC
```

View all information on all network interfaces on the machine.
```sh
ipconfig /all
```

Display the routing table.
```sh
route print
```

View active network connections.
```sh
netstat -ano
```

View firewall profile, if it's enabled etc.
```sh
netsh advfirewall show currentprofile
```

View all the firewall rules.
```sh
netsh advfirewall firewall show rule name=all
```

View the scheduled tasks.
```sh
schtasks /query /fo LIST /v
```

Get the installed programs that have been installed by Windows Installer. (Doesn't show non-installed programs).
```sh
wmic product get name, version, vendor
```

View system wide updates.
```sh
wmic qfe get Caption, Description, HotFixID, InstalledOn
```

View files / directories within the given directory that is read / write by everybody. (In SysinternalsSuite)
```sh
accesschk.exe -uws "Everyone" "C:\Program Files"
```

Powershell script to view files / directories in the given directory that is read / writeable by everybody.
```sh
Get-ChildItem "C:\Program Files" -Recurse | Get-ACL | ?{$_.AccessToString -match "Everyone\sAllow\s\sModify"}
```

List drives that are mounted and drives that are physically connected but unmounted.
```sh
mountvol
```

Get devices drivers and kernel modules. Run in powershell to filter results.
```sh
driverquery.exe /v /fo csv | ConvertFrom-CSV | Select-Object ‘Display Name’, ‘Start Mode’, Path
```

Get driver versions where device like VMWare, run in powershell
```sh
Get-WmiObject Win32_PnPSignedDriver | Select-Object DeviceName, DriverVersion, Manufacturer | Where-Object {$_.DeviceName -like "*VMware*"}
```

If this or the following register is enabled, MSI files can be installed with elavated privledges.
```sh
reg query HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Installer
```

```sh
reg query HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\Installer
```

Reboot the machine.
```sh
shutdown /r /t 0
```
