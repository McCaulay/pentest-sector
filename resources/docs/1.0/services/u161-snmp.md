# 161 (UDP) - SNMP

---

- [Overview](#overview)

> {info} **SNMP** stands for **Simple Network Management Protocol**

<a name="overview"></a>
## Overview

Suscepticle to IP Spoofing and replay attacks.  
Protocols 1, 2, 2c offer no traffic encryption.

Traditional protocols have weak authentication schemes, and commonly left configured with default public and private community strings.

## SNMP Management Information Base (MIB)
Database usually containing network management information (may contain more than just network management information).  
Organised as a tree.  
Values (1.123.21.21.23) corrospond with some value (System.Information).

## Scanning for SNMP
Scan for port 161 SNMP to check if it's open. --open only displays the open ports.
```sh
sudo nmap -sU --open -p 161 192.168.0.1-254 -oG open-snmp.txt
```

Scans the given ips in the ips file for SNMP protocol with the community strings in community file.
```sh
echo public > community
echo private >> community
echo manager >> community
for ip in $(seq 1 254); do echo 192.168.0.$ip; done > ips
onesixtyone -c community -i ips
```

## Windows SNMP Enumeration
Requires read only community string, most cases is “public”.

Enumerators the entire MIB tree (-c community string, -v version number, -t timeout)
```sh
snmpwalk -c public -v1 -t 10 __VICTIM_IP__
```

Enumerates Windows Users
```sh
snmpwalk -c public -v1 __VICTIM_IP__ 1.3.6.1.4.1.77.1.2.25
```

Enumerates Running Windows Processes
```sh
snmpwalk -c public -v1 __VICTIM_IP__ 1.3.6.1.2.1.25.4.2.1.2
```

Enumerating Open TCP Ports
```sh
snmpwalk -c public -v1 __VICTIM_IP__ 1.3.6.1.2.1.6.13.1.3
```

Enumerates installed software
```sh
snmpwalk -c public -v1 __VICTIM_IP__ 1.3.6.1.2.1.25.6.3.1.2
```

## Converting MIBS numbers to names
Install snmp mibs
```sh
sudo apt-get install snmp-mibs-downloader
```

Comment out “mibs :” to enable the names, uncomment to disable.
```sh
/etc/snmp/snmp.conf
```
